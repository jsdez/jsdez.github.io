/*! For license information please see neo-rs-filler.js.LICENSE.txt */
(()=>{"use strict";var e={223:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},i=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{a(n.next(e))}catch(e){r(e)}}function l(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,l)}a((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=o(62),s=o(595),l={version:"1.0",fallbackDisableSubmit:!1,controlName:"neo-rs-filler",description:"Repeating section manipulator",iconUrl:"repeating-section",groupName:"Form Tools",properties:{rsvalues:{type:"string",title:"Control values",description:"Please ensure you first store the array a form variable as text first"},rstarget:{type:"string",title:"CSS class of the Repeating Section",description:"Class name used to target repeating section"},rsfieldtarget:{type:"string",title:"CSS class of the field",description:"Class name used to target field in the repeating section"},rscontroltype:{type:"string",enum:["text-short","text-long","choice-single","choice-multiple","currency","datetime","email","number","yes-no"],title:"Control type in the Repeating Section",description:"Type of control in the repeating section",defaultValue:"text-short"},primaryFiller:{type:"boolean",title:"Primary Filler",description:"When true, this component manages row count (add/remove). When false, only fills data in existing rows.",defaultValue:!1}},standardProperties:{fieldLabel:!1,description:!1,visibility:!0}};class a extends r.LitElement{constructor(){super(),this.rsvalues="",this.rstarget="",this.rsfieldtarget="",this.rscontroltype="text-short",this.primaryFiller=!1,this._isRunning=!1,this._lastApplied=null,this.rsvalues="",this.rstarget="",this.rsfieldtarget="",this.rscontroltype="text-short",this.primaryFiller=!1}firstUpdated(e){super.firstUpdated(e),this.runActions()}updated(e){super.updated(e),(e.has("rsvalues")||e.has("rstarget")||e.has("rsfieldtarget")||e.has("primaryFiller"))&&this.runActions()}waitForElement(e,t=8e3){return i(this,void 0,void 0,(function*(){const o=this.ownerDocument||document;return o.querySelector(e)||new Promise((n=>{const i=new MutationObserver((()=>{const t=o.querySelector(e);t&&(i.disconnect(),n(t))}));i.observe(o.documentElement,{childList:!0,subtree:!0}),setTimeout((()=>{i.disconnect(),n(null)}),t)}))}))}findAddButton(e){console.log("[neo-rs-filler] Looking for add button in/near:",e);const t=e.closest("ntx-repeating-section");if(console.log("[neo-rs-filler] Parent ntx-repeating-section:",t),t){const e=t.nextElementSibling;if(console.log("[neo-rs-filler] Next sibling of ntx-repeating-section:",e),e&&e.classList.contains("btn-repeating-section-new-row"))return console.log("[neo-rs-filler] Found add button as next sibling:",e),e;const o=t.querySelector(".btn-repeating-section-new-row");if(o)return console.log("[neo-rs-filler] Found add button inside ntx-repeating-section:",o),o}const o=document.querySelectorAll(".btn-repeating-section-new-row");if(console.log("[neo-rs-filler] All add buttons in document:",o.length,o),1===o.length)return console.log("[neo-rs-filler] Using the only add button found:",o[0]),o[0];const n=e.nextElementSibling;if(console.log("[neo-rs-filler] Next sibling of rsHost:",n),n){const e=n.querySelector('button.ntx-repeating-section-add-button, button[aria-label="Add"], button[title*="Add"], .btn-repeating-section-new-row');if(e)return console.log("[neo-rs-filler] Found add button in next sibling:",e),e}let i=e.querySelector('button.ntx-repeating-section-add-button, button[aria-label="Add"], button[title*="Add"], .btn-repeating-section-new-row');if(i)return console.log("[neo-rs-filler] Found add button in RS host:",i),i;const r=e.shadowRoot;if(r&&(i=r.querySelector('button.ntx-repeating-section-add-button, button[aria-label="Add"], button[title*="Add"], .btn-repeating-section-new-row'),i))return console.log("[neo-rs-filler] Found add button in shadow root:",i),i;const s=document.querySelectorAll("button");console.log("[neo-rs-filler] Total buttons in document:",s.length);const l=document.querySelectorAll('button[title*="Add"], button[aria-label*="Add"]');console.log("[neo-rs-filler] Potential add buttons by attributes:",l.length,l);const a=Array.from(s).filter((e=>e.textContent&&e.textContent.toLowerCase().includes("add")));return console.log('[neo-rs-filler] Buttons with "add" in text:',a.length,a),null}findRemoveButtons(e){var t,o;const n=e.closest("ntx-repeating-section");if(n){const e=n.querySelectorAll(".ntx-repeating-section-remove-button");console.log("[neo-rs-filler] Remove buttons in ntx-repeating-section:",e.length,e);const t=Array.from(e).filter((e=>!e.disabled));return console.log("[neo-rs-filler] Enabled remove buttons:",t.length,t),t}const i=[e,e.nextElementSibling,e.shadowRoot].filter(Boolean);for(const e of i){const n=null===(o=(t=e).querySelectorAll)||void 0===o?void 0:o.call(t,'button.ntx-repeating-section-remove-button, button[aria-label="Remove"], button[title*="Remove"]');if(n&&n.length)return Array.from(n)}const r=(this.ownerDocument||document).querySelectorAll('button.ntx-repeating-section-remove-button, button[aria-label="Remove"], button[title*="Remove"]');return Array.from(null!=r?r:[])}getCurrentRowCount(e){const t=e.closest("ntx-repeating-section");if(t){const e=t.querySelectorAll(".ntx-repeating-section-repeated-section");if(console.log("[neo-rs-filler] Repeated rows found:",e.length,e),e.length>0)return console.log("[neo-rs-filler] Using repeated rows count:",e.length),e.length}const o=this.findRemoveButtons(e);console.log("[neo-rs-filler] Remove buttons found:",o.length,o);const n=o&&o.length?o.length:1;return console.log("[neo-rs-filler] Calculated current row count:",n),n}runActions(){var e;return i(this,void 0,void 0,(function*(){console.log("[neo-rs-filler] runActions called",{rstarget:this.rstarget,rsfieldtarget:this.rsfieldtarget,rsvalues:this.rsvalues,rscontroltype:this.rscontroltype,primaryFiller:this.primaryFiller}),console.log("[neo-rs-filler] Raw rsvalues value:",this.rsvalues),console.log("[neo-rs-filler] rsvalues type:",typeof this.rsvalues),console.log("[neo-rs-filler] rsvalues length:",null===(e=this.rsvalues)||void 0===e?void 0:e.length);const t=(this.rstarget||"").trim(),o=(this.rsfieldtarget||"").trim(),n=(this.rsvalues||"").trim();if(!t)return void console.warn("[neo-rs-filler] No target class specified");if(!o)return void console.warn("[neo-rs-filler] No field target class specified");if(!n)return void console.warn("[neo-rs-filler] No values specified");if(this._isRunning)return void console.log("[neo-rs-filler] Already running, skipping");let i=[];try{if(i=this.parseInputData(n),!Array.isArray(i))return void console.error("[neo-rs-filler] Parsed data is not an array:",i);console.log("[neo-rs-filler] Successfully parsed input data:",i)}catch(e){return void console.error("[neo-rs-filler] Failed to parse input data:",e,n)}console.log("[neo-rs-filler] Parsed values array:",i);const r=i.length;console.log("[neo-rs-filler] Desired row count based on array length:",r);const s=void 0!==window.CSS&&"function"==typeof CSS.escape?CSS.escape(t):t.replace(/([^a-zA-Z0-9_-])/g,"\\$1"),l=`${s}:${o}:${n}`;if(this._lastApplied===l)return void console.log("[neo-rs-filler] Already applied this configuration, skipping");console.log("[neo-rs-filler] Looking for repeating section:",`.${s}`),this._isRunning=!0;const a=yield this.waitForElement(`.${s}`);if(!a)return console.warn("[neo-rs-filler] Repeating section not found:",t),void(this._isRunning=!1);console.log("[neo-rs-filler] Found RS host:",a);const c=this.getCurrentRowCount(a);if(console.log("[neo-rs-filler] Current row count:",c),this.primaryFiller){if(console.log("[neo-rs-filler] This is the primary filler - managing row count"),c!==r){console.log("[neo-rs-filler] Adjusting row count from",c,"to",r);const e=this.findAddButton(a);if(!e)return console.warn("[neo-rs-filler] Add button not found, cannot adjust rows"),void(this._isRunning=!1);if(c<r){const t=r-c;console.log("[neo-rs-filler] Adding",t,"rows");for(let o=0;o<t;o++)try{const t=c+o;console.log(`[neo-rs-filler] Adding row ${t+1}`),e.click();const n=a.closest("ntx-repeating-section");n&&(yield this.waitForRowToExist(n,t))}catch(e){console.error("[neo-rs-filler] Error adding row:",e)}}else if(c>r){const e=c-r;console.log("[neo-rs-filler] Removing",e,"excess rows");const t=this.findRemoveButtons(a).slice(-e);for(let e=0;e<t.length;e++)try{t[e].click(),yield new Promise((e=>setTimeout(e,100)))}catch(e){console.error("[neo-rs-filler] Error removing row:",e)}}yield new Promise((e=>setTimeout(e,100)))}}else console.log("[neo-rs-filler] This is a secondary filler - skipping row count management"),console.log("[neo-rs-filler] Will fill data in existing",c,"rows with",i.length,"values");yield this.fillRowValues(a,o,i),this._lastApplied=l,this._isRunning=!1,console.log("[neo-rs-filler] runActions completed")}))}fillRowValues(e,t,o){return i(this,void 0,void 0,(function*(){console.log("[neo-rs-filler] Starting to fill row values");const n=e.closest("ntx-repeating-section");if(!n)return void console.error("[neo-rs-filler] Could not find ntx-repeating-section parent");const i=void 0!==window.CSS&&"function"==typeof CSS.escape?CSS.escape(t):t.replace(/([^a-zA-Z0-9_-])/g,"\\$1"),r=n.querySelectorAll(".ntx-repeating-section-repeated-section"),s=Math.min(o.length,r.length);this.primaryFiller?console.log("[neo-rs-filler] Primary filler - will fill",o.length,"values in",o.length,"rows"):(console.log("[neo-rs-filler] Secondary filler - will fill",s,"values in",r.length,"existing rows"),o.length>r.length&&console.warn("[neo-rs-filler] More values than existing rows - some values will be skipped"));for(let e=0;e<s;e++){const r=o[e];if(console.log(`[neo-rs-filler] Processing row ${e+1} with value:`,r),this.primaryFiller&&!(yield this.waitForRowToExist(n,e))){console.warn(`[neo-rs-filler] Row ${e+1} did not appear in DOM, skipping`);continue}const s=n.querySelectorAll(".ntx-repeating-section-repeated-section")[e];if(!s){console.warn(`[neo-rs-filler] Row ${e+1} not found after waiting`);continue}const l=yield this.waitForFieldInRow(s,i);l?(console.log(`[neo-rs-filler] Found target field in row ${e+1}:`,l),yield this.setFieldValue(l,r,this.rscontroltype),console.log(`[neo-rs-filler] Successfully filled row ${e+1}`)):console.warn(`[neo-rs-filler] Target field not found in row ${e+1}:`,t)}console.log("[neo-rs-filler] Completed filling all rows")}))}waitForRowToExist(e,t){return i(this,void 0,void 0,(function*(){const o=e.querySelectorAll(".ntx-repeating-section-repeated-section");return o.length>t&&o[t]?(console.log(`[neo-rs-filler] Row ${t+1} already exists`),!0):(console.log(`[neo-rs-filler] Waiting for row ${t+1} to appear in DOM...`),new Promise((o=>{const n=new MutationObserver((i=>{var r,s;const l=e.querySelectorAll(".ntx-repeating-section-repeated-section");if(l.length>t&&l[t])return console.log(`[neo-rs-filler] Row ${t+1} appeared in DOM`),n.disconnect(),void o(!0);for(const l of i)if("childList"===l.type&&l.addedNodes.length>0)for(const i of Array.from(l.addedNodes))if(i.nodeType===Node.ELEMENT_NODE){const l=i;if((null===(r=l.classList)||void 0===r?void 0:r.contains("ntx-repeating-section-repeated-section"))||(null===(s=l.querySelector)||void 0===s?void 0:s.call(l,".ntx-repeating-section-repeated-section"))){const i=e.querySelectorAll(".ntx-repeating-section-repeated-section");if(i.length>t&&i[t])return console.log(`[neo-rs-filler] Row ${t+1} detected via mutation`),n.disconnect(),void o(!0)}}}));n.observe(e,{childList:!0,subtree:!0}),setTimeout((()=>{n.disconnect(),console.warn(`[neo-rs-filler] Timeout waiting for row ${t+1}`),o(!1)}),5e3)})))}))}waitForFieldInRow(e,t){return i(this,void 0,void 0,(function*(){const o=e.querySelector(`.${t}`);return o?(console.log("[neo-rs-filler] Field already exists in row"),o):(console.log(`[neo-rs-filler] Waiting for field .${t} to appear in row...`),new Promise((o=>{const n=new MutationObserver((i=>{var r,s,l,a;const c=e.querySelector(`.${t}`);if(c)return console.log("[neo-rs-filler] Field appeared in row"),n.disconnect(),void o(c);for(const c of i)if("childList"===c.type&&c.addedNodes.length>0){for(const i of Array.from(c.addedNodes))if(i.nodeType===Node.ELEMENT_NODE){const l=i;if((null===(r=l.classList)||void 0===r?void 0:r.contains(t.replace(/\\/g,"")))||(null===(s=l.querySelector)||void 0===s?void 0:s.call(l,`.${t}`))){const i=e.querySelector(`.${t}`);if(i)return console.log("[neo-rs-filler] Field detected via mutation"),n.disconnect(),void o(i)}}}else if("attributes"===c.type&&c.target.nodeType===Node.ELEMENT_NODE){const i=c.target;if((null===(l=i.classList)||void 0===l?void 0:l.contains(t.replace(/\\/g,"")))||(null===(a=i.querySelector)||void 0===a?void 0:a.call(i,`.${t}`))){const i=e.querySelector(`.${t}`);if(i)return console.log("[neo-rs-filler] Field became available via attribute change"),n.disconnect(),void o(i)}}}));n.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","style"]}),setTimeout((()=>{n.disconnect(),console.warn("[neo-rs-filler] Timeout waiting for field in row"),o(null)}),3e3)})))}))}setFieldValue(e,t,o){return i(this,void 0,void 0,(function*(){console.log("[neo-rs-filler] Setting field value:",{fieldElement:e,value:t,controlType:o});try{switch(o){case"text-short":yield this.setTextShortValue(e,t);break;case"text-long":yield this.setTextLongValue(e,t);break;case"choice-single":yield this.setChoiceSingleValue(e,t);break;case"choice-multiple":yield this.setChoiceMultipleValue(e,t);break;case"currency":yield this.setCurrencyValue(e,t);break;case"datetime":yield this.setDateTimeValue(e,t);break;case"email":yield this.setEmailValue(e,t);break;case"number":yield this.setNumberValue(e,t);break;case"yes-no":yield this.setYesNoValue(e,t);break;default:console.warn("[neo-rs-filler] Unknown control type, defaulting to text-short:",o),yield this.setTextShortValue(e,t)}}catch(e){console.error("[neo-rs-filler] Error setting field value:",e)}}))}setTextShortValue(e,t){return i(this,void 0,void 0,(function*(){const o=e.querySelector('input[type="text"], input:not([type])');if(o){const e=String(t);o.value=e,this.triggerInputEvents(o),console.log("[neo-rs-filler] Set text-short value:",e)}else console.warn("[neo-rs-filler] Text input not found in text-short field")}))}setTextLongValue(e,t){return i(this,void 0,void 0,(function*(){const o=e.querySelector("textarea");if(o){const e=String(t);o.value=e,this.triggerInputEvents(o),console.log("[neo-rs-filler] Set text-long value:",e)}else console.warn("[neo-rs-filler] Textarea not found in text-long field")}))}setChoiceSingleValue(e,t){return i(this,void 0,void 0,(function*(){const o=String(t);console.log("[neo-rs-filler] Setting choice-single value:",o);const n=e.querySelector("ng-select"),i=e.querySelector("ntx-simple-select-single");if(n||i)return console.log("[neo-rs-filler] Found Nintex ng-select dropdown"),void(yield this.setNintexDropdownValue(e,o));const r=e.querySelector("select");if(r)return console.log("[neo-rs-filler] Found standard dropdown"),void(yield this.setSelectValue(r,o));const s=e.querySelectorAll('input[type="radio"]');if(s.length>0)return console.log("[neo-rs-filler] Found radio buttons, attempting to select one"),void(yield this.setRadioValue(s,o));console.warn("[neo-rs-filler] No dropdown or radio buttons found in choice-single field")}))}setNintexDropdownValue(e,t){var o,n;return i(this,void 0,void 0,(function*(){console.log("[neo-rs-filler] Setting Nintex dropdown value:",t);const i=e.querySelector("ng-select input, ntx-simple-select-single input");if(!i)return void console.warn("[neo-rs-filler] No input found in Nintex dropdown");console.log("[neo-rs-filler] Found dropdown input:",i),i.value=t,this.triggerInputEvents(i),i.focus(),yield new Promise((e=>setTimeout(e,200)));const r=document.querySelectorAll("ng-option, .ng-option");console.log("[neo-rs-filler] Available dropdown options:",r.length);let s=!1;const l=t.toLowerCase();for(const e of Array.from(r)){const n=(null===(o=e.textContent)||void 0===o?void 0:o.trim())||"",i=n.toLowerCase();if(console.log("[neo-rs-filler] Checking option:",n),n===t||i===l){console.log("[neo-rs-filler] Found exact match, clicking option:",n),e.click(),s=!0;break}}if(!s)for(const e of Array.from(r)){const t=(null===(n=e.textContent)||void 0===n?void 0:n.trim())||"";if(t.toLowerCase().includes(l)){console.log("[neo-rs-filler] Found partial match, clicking option:",t),e.click(),s=!0;break}}if(s)i.blur();else{console.warn("[neo-rs-filler] No matching option found for value:",t);const e=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,bubbles:!0,cancelable:!0});i.dispatchEvent(e),console.log("[neo-rs-filler] Attempted to select via Enter key")}this.triggerInputEvents(i)}))}setChoiceMultipleValue(e,t){return i(this,void 0,void 0,(function*(){let o;o=Array.isArray(t)?t.map((e=>String(e))):String(t).split(",").map((e=>e.trim())),console.log("[neo-rs-filler] Setting choice-multiple values:",o);const n=e.querySelector("ntx-simple-select-multi"),i=e.querySelector("ng-select");if(n||i)return console.log("[neo-rs-filler] Found Nintex multi-select dropdown"),void(yield this.setNintexMultiSelectValue(e,o));const r=e.querySelector("select[multiple]");if(r)return console.log("[neo-rs-filler] Found standard multi-select dropdown"),void(yield this.setMultiSelectValue(r,o));const s=e.querySelectorAll('input[type="checkbox"]');if(s.length>0)return console.log("[neo-rs-filler] Found checkboxes"),void(yield this.setCheckboxValues(s,o,e));console.warn("[neo-rs-filler] No multi-select or checkboxes found in choice-multiple field")}))}setNintexMultiSelectValue(e,t){var o;return i(this,void 0,void 0,(function*(){console.log("[neo-rs-filler] Setting Nintex multi-select values:",t);const n=e.querySelector("ng-select input, ntx-simple-select-multi input");if(n){console.log("[neo-rs-filler] Found multi-select input:",n);for(let e=0;e<t.length;e++){const i=t[e];console.log(`[neo-rs-filler] Processing value ${e+1}/${t.length}:`,i),n.value=i,this.triggerInputEvents(n),n.focus(),yield new Promise((e=>setTimeout(e,300)));const r=document.querySelectorAll("ng-option, .ng-option");let s=!1;const l=i.toLowerCase();for(const e of Array.from(r)){const t=(null===(o=e.textContent)||void 0===o?void 0:o.trim())||"",n=t.toLowerCase();if(t===i||n===l||n.includes(l)){console.log("[neo-rs-filler] Selecting multi-select option:",t),e.click(),s=!0;break}}if(!s){console.warn("[neo-rs-filler] No matching option found for value:",i);const e=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,bubbles:!0});n.dispatchEvent(e)}n.value="",yield new Promise((e=>setTimeout(e,200)))}n.blur(),this.triggerInputEvents(n)}else console.warn("[neo-rs-filler] No input found in Nintex multi-select")}))}setYesNoValue(e,t){return i(this,void 0,void 0,(function*(){let o;if(console.log("[neo-rs-filler] Setting yes-no value:",t),"boolean"==typeof t)o=t;else if("string"==typeof t){const e=t.toLowerCase().trim();o="true"===e||"yes"===e||"1"===e||"on"===e}else o="number"==typeof t?0!==t:Boolean(t);console.log("[neo-rs-filler] Converted to boolean:",o);const n=e.querySelector('input[type="checkbox"]');if(n)return n.checked=o,this.triggerInputEvents(n),void console.log("[neo-rs-filler] Set checkbox value:",o);const i=e.querySelector('input[role="switch"], input.toggle, .toggle input');if(i)return i.checked=o,this.triggerInputEvents(i),void console.log("[neo-rs-filler] Set toggle value:",o);const r=e.querySelectorAll('input[type="radio"]');if(r.length>0){const e=o?"yes":"no";return void(yield this.setRadioValue(r,e))}const s=e.querySelector("select");if(s){const e=o?"yes":"no";yield this.setSelectValue(s,e)}else console.warn("[neo-rs-filler] No checkbox, toggle, radio buttons, or select found in yes-no field")}))}setSelectValue(e,t){return i(this,void 0,void 0,(function*(){console.log("[neo-rs-filler] Looking for option with value:",t);let o=!1;for(let n=0;n<e.options.length;n++){const i=e.options[n];if(i.value===t||i.text===t){e.selectedIndex=n,o=!0,console.log("[neo-rs-filler] Found exact match, selected option:",i.text,"at index",n);break}}if(!o){const n=t.toLowerCase();for(let t=0;t<e.options.length;t++){const i=e.options[t];if(i.value.toLowerCase()===n||i.text.toLowerCase()===n){e.selectedIndex=t,o=!0,console.log("[neo-rs-filler] Found case-insensitive match, selected option:",i.text,"at index",t);break}}}if(!o){const n=t.toLowerCase();for(let t=0;t<e.options.length;t++){const i=e.options[t];if(i.text.toLowerCase().includes(n)||i.value.toLowerCase().includes(n)){e.selectedIndex=t,o=!0,console.log("[neo-rs-filler] Found partial match, selected option:",i.text,"at index",t);break}}}o?this.triggerInputEvents(e):(console.warn("[neo-rs-filler] No matching option found for value:",t),console.log("[neo-rs-filler] Available options:",Array.from(e.options).map((e=>({value:e.value,text:e.text})))))}))}setRadioValue(e,t){return i(this,void 0,void 0,(function*(){console.log("[neo-rs-filler] Looking for radio button with value:",t);let o=!1;const n=t.toLowerCase();e.forEach((e=>{var t;const i=e.closest("label")||document.querySelector(`label[for="${e.id}"]`),r=(null===(t=null==i?void 0:i.textContent)||void 0===t?void 0:t.trim())||"",s=e.value.toLowerCase(),l=r.toLowerCase();s===n||l===n||"yes"===n&&("true"===s||"true"===l)||"no"===n&&("false"===s||"false"===l)?(e.checked=!0,this.triggerInputEvents(e),o=!0,console.log("[neo-rs-filler] Selected radio button:",r||e.value)):e.checked=!1})),o||(console.warn("[neo-rs-filler] No matching radio button found for value:",t),console.log("[neo-rs-filler] Available radio options:",Array.from(e).map((e=>{var t;const o=e.closest("label")||document.querySelector(`label[for="${e.id}"]`);return{value:e.value,text:(null===(t=null==o?void 0:o.textContent)||void 0===t?void 0:t.trim())||""}}))))}))}setMultiSelectValue(e,t){return i(this,void 0,void 0,(function*(){for(let t=0;t<e.options.length;t++)e.options[t].selected=!1;t.forEach((t=>{for(let o=0;o<e.options.length;o++){const n=e.options[o];n.value!==t&&n.text!==t&&n.value.toLowerCase()!==t.toLowerCase()&&n.text.toLowerCase()!==t.toLowerCase()||(n.selected=!0,console.log("[neo-rs-filler] Selected multi-select option:",n.text))}})),this.triggerInputEvents(e)}))}setCheckboxValues(e,t,o){return i(this,void 0,void 0,(function*(){e.forEach((e=>e.checked=!1)),t.forEach((t=>{const n=t.toLowerCase();e.forEach((e=>{var i;const r=e.closest("label")||o.querySelector(`label[for="${e.id}"]`),s=(null===(i=null==r?void 0:r.textContent)||void 0===i?void 0:i.trim())||"";e.value!==t&&s!==t&&e.value.toLowerCase()!==n&&s.toLowerCase()!==n||(e.checked=!0,this.triggerInputEvents(e),console.log("[neo-rs-filler] Checked checkbox:",s||e.value))}))}))}))}setCurrencyValue(e,t){return i(this,void 0,void 0,(function*(){const o=e.querySelector('input[type="number"], input[type="text"]');if(o){const e="number"==typeof t?t:parseFloat(String(t).replace(/[^0-9.-]/g,"")),n=isNaN(e)?"0":String(e);o.value=n,this.triggerInputEvents(o),console.log("[neo-rs-filler] Set currency value:",n)}else console.warn("[neo-rs-filler] Input not found in currency field")}))}setDateTimeValue(e,t){return i(this,void 0,void 0,(function*(){const o=e.querySelector('input[type="date"], input[type="datetime-local"], input[type="time"], input[type="text"]');if(o){let e;e=t instanceof Date?"date"===o.type?t.toISOString().split("T")[0]:"datetime-local"===o.type?t.toISOString().slice(0,16):"time"===o.type?t.toTimeString().slice(0,5):t.toISOString():String(t),o.value=e,this.triggerInputEvents(o),console.log("[neo-rs-filler] Set datetime value:",e)}else console.warn("[neo-rs-filler] Date input not found in datetime field")}))}setEmailValue(e,t){return i(this,void 0,void 0,(function*(){const o=e.querySelector('input[type="email"], input[type="text"]');if(o){const e=String(t);o.value=e,this.triggerInputEvents(o),console.log("[neo-rs-filler] Set email value:",e)}else console.warn("[neo-rs-filler] Email input not found in email field")}))}setNumberValue(e,t){return i(this,void 0,void 0,(function*(){const o=e.querySelector('input[type="number"], input[type="text"]');if(o){const e="number"==typeof t?t:parseFloat(String(t)),n=isNaN(e)?"0":String(e);o.value=n,this.triggerInputEvents(o),console.log("[neo-rs-filler] Set number value:",n)}else console.warn("[neo-rs-filler] Number input not found in number field")}))}triggerInputEvents(e){e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),e.dispatchEvent(new Event("blur",{bubbles:!0}))}detectInputFormat(e){const t=e.trim();if(!t)return{format:"empty",confidence:1,details:"No input provided"};if(t.startsWith("[")&&t.endsWith("]"))try{const e=JSON.parse(t);if(Array.isArray(e))return{format:"json-array",confidence:.95,details:`Valid JSON array with ${e.length} items`}}catch(e){return{format:"malformed-json",confidence:.8,details:"Looks like JSON array but has syntax errors"}}if(t.startsWith("{")&&t.endsWith("}"))try{return JSON.parse(t),{format:"json-object",confidence:.9,details:"Valid JSON object"}}catch(e){return{format:"malformed-json",confidence:.7,details:"Looks like JSON object but has syntax errors"}}return!t.includes(",")||t.includes("[")||t.includes("{")?t.includes("|")?{format:"pipe-separated",confidence:.7,details:`Pipe-separated values (${(t.match(/\|/g)||[]).length+1} items)`}:t.includes("\n")?{format:"newline-separated",confidence:.8,details:`Newline-separated values (${t.split("\n").filter((e=>e.trim())).length} items)`}:{format:"single-value",confidence:.9,details:"Single text value"}:{format:"csv",confidence:.8,details:`Comma-separated values (${(t.match(/,/g)||[]).length+1} items)`}}parseInputData(e){const t=this.detectInputFormat(e),o=e.trim();switch(console.log("[neo-rs-filler] Input format detection:",t),t.format){case"empty":return[];case"json-array":try{const e=JSON.parse(o);if(Array.isArray(e))return e;throw new Error("Parsed JSON is not an array")}catch(e){throw new Error(`JSON parsing failed: ${e instanceof Error?e.message:"Unknown error"}`)}case"json-object":try{return[JSON.parse(o)]}catch(e){throw new Error(`JSON parsing failed: ${e instanceof Error?e.message:"Unknown error"}`)}case"csv":return o.split(",").map((e=>{const t=e.trim();return/^\d+(\.\d+)?$/.test(t)?Number(t):"true"===t.toLowerCase()||"false"!==t.toLowerCase()&&(t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1):t)}));case"pipe-separated":return o.split("|").map((e=>e.trim()));case"newline-separated":return o.split("\n").map((e=>e.trim())).filter((e=>e.length>0));case"single-value":return/^\d+(\.\d+)?$/.test(o)?[Number(o)]:"true"===o.toLowerCase()?[!0]:"false"===o.toLowerCase()?[!1]:[o];case"malformed-json":try{let e=o.replace(/'/g,'"').replace(/(\w+):/g,'"$1":').replace(/,(\s*[}\]])/g,"$1");const t=JSON.parse(e);return Array.isArray(t)?(console.log("[neo-rs-filler] Successfully fixed malformed JSON"),t):[t]}catch(e){return console.warn("[neo-rs-filler] Could not fix malformed JSON, treating as CSV"),o.split(",").map((e=>e.trim()))}default:throw new Error(`Unsupported format: ${t.format}`)}}render(){console.log("[neo-rs-filler] Raw rsvalues in render:",this.rsvalues);let e="none",t="unknown";if(this.rsvalues){t=this.detectInputFormat(this.rsvalues).format;try{e=`${this.parseInputData(this.rsvalues).length} items`}catch(t){e=`parsing error: ${t instanceof Error?t.message:"Unknown error"}`}}return r.html`
      <div>
        <div>Raw rsvalues: ${this.rsvalues||"(empty)"}</div>
        <div>Format: ${t}</div>
        <div>Parsed: ${e}</div>
        <div>Mode: ${this.primaryFiller?"Primary (manages rows)":"Secondary (fills only)"}</div>
      </div>
    `}static getMetaConfig(){return l}}n([(0,s.property)({type:String})],a.prototype,"rsvalues",void 0),n([(0,s.property)({type:String})],a.prototype,"rstarget",void 0),n([(0,s.property)({type:String})],a.prototype,"rsfieldtarget",void 0),n([(0,s.property)({type:String})],a.prototype,"rscontroltype",void 0),n([(0,s.property)({type:Boolean})],a.prototype,"primaryFiller",void 0),customElements.define("neo-rs-filler",a)},595:(e,t,o)=>{o.r(t),o.d(t,{customElement:()=>n,eventOptions:()=>a,property:()=>r,query:()=>c,queryAll:()=>u,queryAssignedElements:()=>f,queryAssignedNodes:()=>g,queryAsync:()=>d,state:()=>s});const n=e=>t=>"function"==typeof t?((e,t)=>(customElements.define(e,t),t))(e,t):((e,t)=>{const{kind:o,elements:n}=t;return{kind:o,elements:n,finisher(t){customElements.define(e,t)}}})(e,t),i=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(o){o.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(o){o.createProperty(t.key,e)}};function r(e){return(t,o)=>void 0!==o?((e,t,o)=>{t.constructor.createProperty(o,e)})(e,t,o):i(e,t)}function s(e){return r({...e,state:!0})}const l=({finisher:e,descriptor:t})=>(o,n)=>{var i;if(void 0===n){const n=null!==(i=o.originalKey)&&void 0!==i?i:o.key,r=null!=t?{kind:"method",placement:"prototype",key:n,descriptor:t(o.key)}:{...o,key:n};return null!=e&&(r.finisher=function(t){e(t,n)}),r}{const i=o.constructor;void 0!==t&&Object.defineProperty(o,n,t(n)),null==e||e(i,n)}};function a(e){return l({finisher:(t,o)=>{Object.assign(t.prototype[o],e)}})}function c(e,t){return l({descriptor:o=>{const n={get(){var t,o;return null!==(o=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(e))&&void 0!==o?o:null},enumerable:!0,configurable:!0};if(t){const t="symbol"==typeof o?Symbol():"__"+o;n.get=function(){var o,n;return void 0===this[t]&&(this[t]=null!==(n=null===(o=this.renderRoot)||void 0===o?void 0:o.querySelector(e))&&void 0!==n?n:null),this[t]}}return n}})}function u(e){return l({descriptor:t=>({get(){var t,o;return null!==(o=null===(t=this.renderRoot)||void 0===t?void 0:t.querySelectorAll(e))&&void 0!==o?o:[]},enumerable:!0,configurable:!0})})}function d(e){return l({descriptor:t=>({async get(){var t;return await this.updateComplete,null===(t=this.renderRoot)||void 0===t?void 0:t.querySelector(e)},enumerable:!0,configurable:!0})})}var h;const p=null!=(null===(h=window.HTMLSlotElement)||void 0===h?void 0:h.prototype.assignedElements)?(e,t)=>e.assignedElements(t):(e,t)=>e.assignedNodes(t).filter((e=>e.nodeType===Node.ELEMENT_NODE));function f(e){const{slot:t,selector:o}=null!=e?e:{};return l({descriptor:n=>({get(){var n;const i="slot"+(t?`[name=${t}]`:":not([name])"),r=null===(n=this.renderRoot)||void 0===n?void 0:n.querySelector(i),s=null!=r?p(r,e):[];return o?s.filter((e=>e.matches(o))):s},enumerable:!0,configurable:!0})})}function g(e,t,o){let n,i=e;return"object"==typeof e?(i=e.slot,n=e):n={flatten:t},o?f({slot:i,flatten:t,selector:o}):l({descriptor:e=>({get(){var e,t;const o="slot"+(i?`[name=${i}]`:":not([name])"),r=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(o);return null!==(t=null==r?void 0:r.assignedNodes(n))&&void 0!==t?t:[]},enumerable:!0,configurable:!0})})}},62:(e,t,o)=>{o.r(t),o.d(t,{CSSResult:()=>l,LitElement:()=>ue,ReactiveElement:()=>w,UpdatingElement:()=>ce,_$LE:()=>he,_$LH:()=>ie,adoptStyles:()=>u,css:()=>c,defaultConverter:()=>y,getCompatibleStyle:()=>d,html:()=>H,isServer:()=>pe,noChange:()=>D,notEqual:()=>m,nothing:()=>B,render:()=>se,supportsAdoptingStyleSheets:()=>i,svg:()=>j,unsafeCSS:()=>a});const n=window,i=n.ShadowRoot&&(void 0===n.ShadyCSS||n.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,r=Symbol(),s=new WeakMap;class l{constructor(e,t,o){if(this._$cssResult$=!0,o!==r)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(i&&void 0===e){const o=void 0!==t&&1===t.length;o&&(e=s.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),o&&s.set(t,e))}return e}toString(){return this.cssText}}const a=e=>new l("string"==typeof e?e:e+"",void 0,r),c=(e,...t)=>{const o=1===e.length?e[0]:t.reduce(((t,o,n)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+e[n+1]),e[0]);return new l(o,e,r)},u=(e,t)=>{i?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const o=document.createElement("style"),i=n.litNonce;void 0!==i&&o.setAttribute("nonce",i),o.textContent=t.cssText,e.appendChild(o)}))},d=i?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const o of e.cssRules)t+=o.cssText;return a(t)})(e):e;var h;const p=window,f=p.trustedTypes,g=f?f.emptyScript:"",v=p.reactiveElementPolyfillSupport,y={toAttribute(e,t){switch(t){case Boolean:e=e?g:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let o=e;switch(t){case Boolean:o=null!==e;break;case Number:o=null===e?null:Number(e);break;case Object:case Array:try{o=JSON.parse(e)}catch(e){o=null}}return o}},m=(e,t)=>t!==e&&(t==t||e==e),b={attribute:!0,type:String,converter:y,reflect:!1,hasChanged:m};class w extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,o)=>{const n=this._$Ep(o,t);void 0!==n&&(this._$Ev.set(n,o),e.push(n))})),e}static createProperty(e,t=b){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const o="symbol"==typeof e?Symbol():"__"+e,n=this.getPropertyDescriptor(e,o,t);void 0!==n&&Object.defineProperty(this.prototype,e,n)}}static getPropertyDescriptor(e,t,o){return{get(){return this[t]},set(n){const i=this[e];this[t]=n,this.requestUpdate(e,i,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||b}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const o of t)this.createProperty(o,e[o])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const o=new Set(e.flat(1/0).reverse());for(const e of o)t.unshift(d(e))}else void 0!==e&&t.push(d(e));return t}static _$Ep(e,t){const o=t.attribute;return!1===o?void 0:"string"==typeof o?o:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,o;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(o=e.hostConnected)||void 0===o||o.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return u(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$EO(e,t,o=b){var n;const i=this.constructor._$Ep(e,o);if(void 0!==i&&!0===o.reflect){const r=(void 0!==(null===(n=o.converter)||void 0===n?void 0:n.toAttribute)?o.converter:y).toAttribute(t,o.type);this._$El=e,null==r?this.removeAttribute(i):this.setAttribute(i,r),this._$El=null}}_$AK(e,t){var o;const n=this.constructor,i=n._$Ev.get(e);if(void 0!==i&&this._$El!==i){const e=n.getPropertyOptions(i),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(o=e.converter)||void 0===o?void 0:o.fromAttribute)?e.converter:y;this._$El=i,this[i]=r.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,o){let n=!0;void 0!==e&&(((o=o||this.constructor.getPropertyOptions(e)).hasChanged||m)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===o.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,o))):n=!1),!this.isUpdatePending&&n&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const o=this._$AL;try{t=this.shouldUpdate(o),t?(this.willUpdate(o),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(o)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(o)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}var S;w.finalized=!0,w.elementProperties=new Map,w.elementStyles=[],w.shadowRootOptions={mode:"open"},null==v||v({ReactiveElement:w}),(null!==(h=p.reactiveElementVersions)&&void 0!==h?h:p.reactiveElementVersions=[]).push("1.6.1");const $=window,A=$.trustedTypes,_=A?A.createPolicy("lit-html",{createHTML:e=>e}):void 0,E=`lit$${(Math.random()+"").slice(9)}$`,x="?"+E,C=`<${x}>`,N=document,k=(e="")=>N.createComment(e),R=e=>null===e||"object"!=typeof e&&"function"!=typeof e,P=Array.isArray,T=e=>P(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]),O=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,L=/-->/g,q=/>/g,F=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),U=/'/g,M=/"/g,V=/^(?:script|style|textarea|title)$/i,I=e=>(t,...o)=>({_$litType$:e,strings:t,values:o}),H=I(1),j=I(2),D=Symbol.for("lit-noChange"),B=Symbol.for("lit-nothing"),z=new WeakMap,W=N.createTreeWalker(N,129,null,!1),J=(e,t)=>{const o=e.length-1,n=[];let i,r=2===t?"<svg>":"",s=O;for(let t=0;t<o;t++){const o=e[t];let l,a,c=-1,u=0;for(;u<o.length&&(s.lastIndex=u,a=s.exec(o),null!==a);)u=s.lastIndex,s===O?"!--"===a[1]?s=L:void 0!==a[1]?s=q:void 0!==a[2]?(V.test(a[2])&&(i=RegExp("</"+a[2],"g")),s=F):void 0!==a[3]&&(s=F):s===F?">"===a[0]?(s=null!=i?i:O,c=-1):void 0===a[1]?c=-2:(c=s.lastIndex-a[2].length,l=a[1],s=void 0===a[3]?F:'"'===a[3]?M:U):s===M||s===U?s=F:s===L||s===q?s=O:(s=F,i=void 0);const d=s===F&&e[t+1].startsWith("/>")?" ":"";r+=s===O?o+C:c>=0?(n.push(l),o.slice(0,c)+"$lit$"+o.slice(c)+E+d):o+E+(-2===c?(n.push(void 0),t):d)}const l=r+(e[o]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==_?_.createHTML(l):l,n]};class K{constructor({strings:e,_$litType$:t},o){let n;this.parts=[];let i=0,r=0;const s=e.length-1,l=this.parts,[a,c]=J(e,t);if(this.el=K.createElement(a,o),W.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(n=W.nextNode())&&l.length<s;){if(1===n.nodeType){if(n.hasAttributes()){const e=[];for(const t of n.getAttributeNames())if(t.endsWith("$lit$")||t.startsWith(E)){const o=c[r++];if(e.push(t),void 0!==o){const e=n.getAttribute(o.toLowerCase()+"$lit$").split(E),t=/([.?@])?(.*)/.exec(o);l.push({type:1,index:i,name:t[2],strings:e,ctor:"."===t[1]?X:"?"===t[1]?te:"@"===t[1]?oe:Q})}else l.push({type:6,index:i})}for(const t of e)n.removeAttribute(t)}if(V.test(n.tagName)){const e=n.textContent.split(E),t=e.length-1;if(t>0){n.textContent=A?A.emptyScript:"";for(let o=0;o<t;o++)n.append(e[o],k()),W.nextNode(),l.push({type:2,index:++i});n.append(e[t],k())}}}else if(8===n.nodeType)if(n.data===x)l.push({type:2,index:i});else{let e=-1;for(;-1!==(e=n.data.indexOf(E,e+1));)l.push({type:7,index:i}),e+=E.length-1}i++}}static createElement(e,t){const o=N.createElement("template");return o.innerHTML=e,o}}function Z(e,t,o=e,n){var i,r,s,l;if(t===D)return t;let a=void 0!==n?null===(i=o._$Co)||void 0===i?void 0:i[n]:o._$Cl;const c=R(t)?void 0:t._$litDirective$;return(null==a?void 0:a.constructor)!==c&&(null===(r=null==a?void 0:a._$AO)||void 0===r||r.call(a,!1),void 0===c?a=void 0:(a=new c(e),a._$AT(e,o,n)),void 0!==n?(null!==(s=(l=o)._$Co)&&void 0!==s?s:l._$Co=[])[n]=a:o._$Cl=a),void 0!==a&&(t=Z(e,a._$AS(e,t.values),a,n)),t}class Y{constructor(e,t){this.u=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(e){var t;const{el:{content:o},parts:n}=this._$AD,i=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:N).importNode(o,!0);W.currentNode=i;let r=W.nextNode(),s=0,l=0,a=n[0];for(;void 0!==a;){if(s===a.index){let t;2===a.type?t=new G(r,r.nextSibling,this,e):1===a.type?t=new a.ctor(r,a.name,a.strings,this,e):6===a.type&&(t=new ne(r,this,e)),this.u.push(t),a=n[++l]}s!==(null==a?void 0:a.index)&&(r=W.nextNode(),s++)}return i}p(e){let t=0;for(const o of this.u)void 0!==o&&(void 0!==o.strings?(o._$AI(e,o,t),t+=o.strings.length-2):o._$AI(e[t])),t++}}class G{constructor(e,t,o,n){var i;this.type=2,this._$AH=B,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=o,this.options=n,this._$Cm=null===(i=null==n?void 0:n.isConnected)||void 0===i||i}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cm}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Z(this,e,t),R(e)?e===B||null==e||""===e?(this._$AH!==B&&this._$AR(),this._$AH=B):e!==this._$AH&&e!==D&&this.g(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):T(e)?this.k(e):this.g(e)}O(e,t=this._$AB){return this._$AA.parentNode.insertBefore(e,t)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}g(e){this._$AH!==B&&R(this._$AH)?this._$AA.nextSibling.data=e:this.T(N.createTextNode(e)),this._$AH=e}$(e){var t;const{values:o,_$litType$:n}=e,i="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=K.createElement(n.h,this.options)),n);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===i)this._$AH.p(o);else{const e=new Y(i,this),t=e.v(this.options);e.p(o),this.T(t),this._$AH=e}}_$AC(e){let t=z.get(e.strings);return void 0===t&&z.set(e.strings,t=new K(e)),t}k(e){P(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let o,n=0;for(const i of e)n===t.length?t.push(o=new G(this.O(k()),this.O(k()),this,this.options)):o=t[n],o._$AI(i),n++;n<t.length&&(this._$AR(o&&o._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){var o;for(null===(o=this._$AP)||void 0===o||o.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cm=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class Q{constructor(e,t,o,n,i){this.type=1,this._$AH=B,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=i,o.length>2||""!==o[0]||""!==o[1]?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=B}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,o,n){const i=this.strings;let r=!1;if(void 0===i)e=Z(this,e,t,0),r=!R(e)||e!==this._$AH&&e!==D,r&&(this._$AH=e);else{const n=e;let s,l;for(e=i[0],s=0;s<i.length-1;s++)l=Z(this,n[o+s],t,s),l===D&&(l=this._$AH[s]),r||(r=!R(l)||l!==this._$AH[s]),l===B?e=B:e!==B&&(e+=(null!=l?l:"")+i[s+1]),this._$AH[s]=l}r&&!n&&this.j(e)}j(e){e===B?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class X extends Q{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===B?void 0:e}}const ee=A?A.emptyScript:"";class te extends Q{constructor(){super(...arguments),this.type=4}j(e){e&&e!==B?this.element.setAttribute(this.name,ee):this.element.removeAttribute(this.name)}}class oe extends Q{constructor(e,t,o,n,i){super(e,t,o,n,i),this.type=5}_$AI(e,t=this){var o;if((e=null!==(o=Z(this,e,t,0))&&void 0!==o?o:B)===D)return;const n=this._$AH,i=e===B&&n!==B||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,r=e!==B&&(n===B||i);i&&this.element.removeEventListener(this.name,this,n),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,o;"function"==typeof this._$AH?this._$AH.call(null!==(o=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==o?o:this.element,e):this._$AH.handleEvent(e)}}class ne{constructor(e,t,o){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(e){Z(this,e)}}const ie={P:"$lit$",A:E,M:x,C:1,L:J,R:Y,D:T,V:Z,I:G,H:Q,N:te,U:oe,B:X,F:ne},re=$.litHtmlPolyfillSupport;null==re||re(K,G),(null!==(S=$.litHtmlVersions)&&void 0!==S?S:$.litHtmlVersions=[]).push("2.6.1");const se=(e,t,o)=>{var n,i;const r=null!==(n=null==o?void 0:o.renderBefore)&&void 0!==n?n:t;let s=r._$litPart$;if(void 0===s){const e=null!==(i=null==o?void 0:o.renderBefore)&&void 0!==i?i:null;r._$litPart$=s=new G(t.insertBefore(k(),e),e,void 0,null!=o?o:{})}return s._$AI(e),s};var le,ae;const ce=w;class ue extends w{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const o=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=o.firstChild),o}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=se(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return D}}ue.finalized=!0,ue._$litElement$=!0,null===(le=globalThis.litElementHydrateSupport)||void 0===le||le.call(globalThis,{LitElement:ue});const de=globalThis.litElementPolyfillSupport;null==de||de({LitElement:ue});const he={_$AK:(e,t,o)=>{e._$AK(t,o)},_$AL:e=>e._$AL};(null!==(ae=globalThis.litElementVersions)&&void 0!==ae?ae:globalThis.litElementVersions=[]).push("3.2.2");const pe=!1}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o(223)})();